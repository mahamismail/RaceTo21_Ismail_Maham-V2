@page "/OverallScore"
@using RaceTo21_BlazorApp

@inject NavigationManager NavigationManager

<style>

	body {
		font-family: 'Montserrat', sans-serif;
	}

	.btn-purple {
		background-color: purple;
		color: #fff; /* text color */
	}

	.btn-rounded {
		border-radius: 50px; /* make the button fully rounded */
		padding: 10px 20px; /* adjust the padding to your preference */
		font-size: 16px; /* adjust the font size to your preference */
		font-weight: 500;
	}

	.btn-white {
		color: purple;
	}

	#numberInput {
		background-color: #D3D3D3; /* set the background color to grey */
		width: 200px; /* set the width to your desired size */
		margin: 20px;
		font-size: 20px;
		font-weight: bold;
		text-align: center;
	}

	.row {
		justify-content: center
	}

	.form-group {
		height: 100%;
		width: 100%;
		margin: 10px;
		display: inline-block;
	}

	.form-control {
		background-color: #CBC3E3; /* set the background color to grey */
		width: 200px; /* set the width to your desired size */
		height: 100px;
		font-size: 20px;
		font-weight: bold;
		text-align: center;
		padding: 10px;
	}

	p {
		width: 70%;
		text-align: center;
		padding-bottom: 20px;
	}

	.container {
		padding: 80px 0 80px 0;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
	}

	h1 {
		padding: 10px 10px 10px 10px;
		font-size: 45px;
		font-weight: bold;
		color: purple;
		text-align: center;
		margin-top: 10px;
	}

	h2 {
		padding: 10px 10px 10px 10px;
		font-size: 25px;
		font-weight: bold;
		text-align: center;
		margin-top: 10px;
	}

	img {
		width: 30%;
	}

	.purple-outline {
		outline: 5px solid purple;
		background-color: #CBC3E3;
	}

</style>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">


<div class="container">

	@switch (Game.nextTask)
	{
		case AllTasks.ShowOverallScores:
			<div class="container @OuterContainerChange()">

				<h2 class="text-center mt-4">Overall Scores</h2>

				@if (overallWinner != null)
				{
					<h3>🎊 ~ <b>@overallWinner.name</b> is the winner! ~ 🎊</h3>
				}
				else { 
					<p>Need above 50 points to win the game!</p>
				}

				<div class="row mt-12" style="padding: 5px">

					@foreach (Player player in Game.players)
					{
						<div class="col md-2">
							<div class="form-group">
								<label for="@player.name">@player.name </label>
								<input type="text" class="form-control" id="@player.name" readonly value="@player.overallScore" style="width: 200px">
							</div>
						</div>
					}

				</div>

				@if (overallWinner == null)
				{
					<button class="btn btn-purple btn-rounded mt-4" type="button" @onclick="() => { Game.nextTask = AllTasks.PlayerTurn; Game.CheckIfCurrent(); Game.ResetRound(); GoToGamePage(); }">BEGIN ROUND @(Game.rounds + 1)</button>
					<button type="button" class="btn btn-white btn-rounded mt-2" @onclick="() => { LeaveGame(); Game.ResetRound(); }">
						← Leave Game
					</button>
				}
				else
				{
					<button class="btn btn-purple btn-rounded mt-4" type="button" @onclick="() => { GoToPlayerPage(); Index.SetUpGame();}">Play Again</button>
					<button type="button" class="btn btn-white btn-rounded mt-2" @onclick="() => { LeaveGame(); }">
						← Exit Game
					</button>
				}
			
			</div>
			break;
	}
		
</div>


@code {

	private Player overallWinner;

	protected override void OnInitialized()
	{
		overallWinner = Game.DoOverallScoring();
	}

	private string OuterContainerChange()
	{
		if (overallWinner != null)
		{
			return "purple-outline";
		}
		return "";
	}

	private void GoToPlayerPage()
	{
		NavigationManager.NavigateTo("/NumberOfPlayers");
	}

	private void LeaveGame()
	{

		NavigationManager.NavigateTo("/");
	}

	private void GoToGamePage()
	{

		NavigationManager.NavigateTo("/Gameplay");
	}
}
